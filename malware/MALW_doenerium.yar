import "pe"

rule doenerium_infostealer
{
	meta:
		version = "1.0"
		first_imported = "2023-07-08"
		last_modified = "2023-07-08"
		status = "RELEASED"
		sharing = "TLP:CLEAR"
		source = "Manual investigate"
		author = "TTC-CERT"
		description = "Detect Doenerium Infostealer strings in memory"
		hash = "4e565f5ec243d536b861d4dbb7570f6a5b44e177a9945a6bc8ec254dd23770b2"
		
	strings:
		$cmd1 = "powershell Get-Clipboard"
		$cmd2 = "netsh lan show profiles"
		$cmd3 = "ipconfig /all"
		$cmd4 = "netstat -r"
		$connection1 = "discord.com/api/webhooks"
		$connection2 = "axios/0.27.2"
		$connection3= "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36 Edg/85.0.564.44"
	
	condition:
		pe.is_pe
		and (all of ($cmd*) and 2 of ($connection*))
}