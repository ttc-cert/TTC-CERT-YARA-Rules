rule webshell_citrix_vulnerability_compromise_php {
   meta:
      version = "1.0"
      first_imported = "2023-09-25"
      last_modified = "2023-09-25"
      status = "RELEASED"
      sharing = "TLP:CLEAR"
      source = "Manual investigate"
      author = "TTC-CERT"
      description = "Detects the presence of a webshell associated with the Citrix vulnerability compromise."
      hash1 = "7b10e1a89df23900fcbbd60d6a2f0272f2bde6b7896df1bdcf1e55db70f323ef"
      hash2 = "3c498c99b7f52099924412ce3d5de489e2bb4d34afc3378dec8b3de5dd8894d5"
   strings:
      $s1 = "http_response_code(" nocase
      $s2 = "eval(base64_decode($_POST" nocase fullword
      $s3 = "@$_POST" nocase fullword
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      2 of them
}
